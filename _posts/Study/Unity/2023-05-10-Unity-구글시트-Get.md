---
title: Unity GoogleSheet Get
author: LHH
date: 2023-05-10 14:25 GMT+0900
categories: [Study, Unity]
tags: [Unity, GoogleSheet, Get]
---

ë¡œì»¬ì—ì„œ ì—‘ì…€íŒŒì¼ì„ ìœ ë‹ˆí‹° í´ë”ì— ë„£ì–´ ê´€ë¦¬í•˜ê¸°ê°€ ë¶ˆí¸í•´ì„œ êµ¬ê¸€ì‹œíŠ¸ì™€ ì—°ê²°í•˜ì—¬ ì‰½ê²Œ ì‚¬ìš©í•´ë³´ë ¤ê³  í•œë‹¤.

## GoogleSheet
êµ¬ê¸€ì‹œíŠ¸ëŠ” ë°±ì—”ë“œ ì„œë²„ì²˜ëŸ¼ ì‚¬ìš© ê°€ëŠ¥í•˜ë©° Get, Post ë“±ì´ ê°€ëŠ¥í•˜ë‹¤.

êµ¬ê¸€ì‹œíŠ¸ì˜ ì¥ì ì€ ë¬´ë£Œë¼ëŠ” ì ì´ê³ , ë§¤ìš° í¸ë¦¬í•˜ê²Œ ë°±ì—”ë“œ ì„œë²„ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

í˜‘ì—…ì—ì„œë„ ì—‘ì…€íŒŒì¼ì„ ë³´ë‚´ëŠ” ë¶ˆí¸í•¨ì„ ì—†ì•¨ ìˆ˜ ìˆê³  ìˆ˜ì •í•˜ëŠ” ì¦‰ì‹œ ë°˜ì˜ë˜ë©° 1ì¸ ê°œë°œì—ì„œë„ ë§¤ìš° ë„ì›€ì´ ë  ê²ƒì´ë‹¤.

## GoogleSheet ì‚¬ìš©ë²•
### ğŸ“ GoogleSheet ê°’
![](https://github.com/LHuHyeon/MY_MMORPG/assets/110723307/e98ecba1-a1e1-474f-9445-69cf91ab963e)

### ğŸ’» ì½”ë“œ
```cs
// ì‹œíŠ¸ í˜•ì‹ê³¼ ê°™ê²Œ ìƒì„±
public class StartData
{
    [XmlAttribute]
    public int Id;
    [XmlAttribute]
    public int exp;
    [XmlAttribute]
    public int level;
    [XmlAttribute]
    public int maxHp;
    [XmlAttribute]
    public int maxMp;
    [XmlAttribute]
    public int STR;
    [XmlAttribute]
    public int Speed;
    [XmlAttribute]
    public int LUK;
    [XmlAttribute]
    public int gold;
}

class GoogleSheetManager : MonoBehaviour
{
    // "https://docs.google.com/spreadsheets/d/êµ¬ê¸€ì‹œíŠ¸ID/export?format=csv&gid=0"
    // ?format=csv : csvë¡œ ì¶œë ¥ë¨.
    // &gid=       : ì‹œíŠ¸ ë²ˆí˜¸ ì§€ì • ê°€ëŠ¥
    const string URL = ""; // êµ¬ê¸€ ì‹œíŠ¸ ì£¼ì†Œ ì‘ì„±

    // êµ¬ê¸€ ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ ë°›ì„ ê³³
    public Dictionary<int, StartData> Start = new Dictionary<int, StartData>();

    void Start()
    {
        StartCoroutine(DataRequest());
    }

    public IEnumerator DataRequest()
    {
        UnityWebRequest www = UnityWebRequest.Get();

        yield return www.SendWebRequest();

        string data = www.downloadHandler.text;

        // ë°ì´í„° ë”•ì…”ë„ˆë¦¬ì— ì €ì¥ì‹œí‚¤ê¸°
        string[] lines = data.Split("\n");
        for(int y=1; y < lines.Length; y++)
        {
            string[] row = lines[y].Replace("\r", "").Split(',');
            if (row.Length == 0)
                continue;
            if (string.IsNullOrEmpty(row[0]))
                continue;

            StartData startData = new StartData()
            {
                Id = int.Parse(row[0]),
                exp = int.Parse(row[1]),
                level = int.Parse(row[2]),
                maxHp = int.Parse(row[3]),
                maxMp = int.Parse(row[4]),
                STR = int.Parse(row[5]),
                Speed = int.Parse(row[6]),
                LUK = int.Parse(row[7]),
            };

            Start.Add(startData.Id, startData);
        }

        // ì˜ ë“¤ì–´ê°”ë‚˜ í™•ì¸
        for(int i=1; i<=Start.Count; i++)
        {
            if (Start.TryGetValue(i, out StartData value) == false)
                Debug.Log($"{i} : false");
            else
                Debug.Log(value.level + " " + value.exp + " " + value.maxHp);
        }
    }
}
```

<br>

## ğŸ’¡ ì°¸ê³ 
- [ê³ ë¼ë‹ˆTV: êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì—°ë™](https://www.youtube.com/watch?v=3LxaTtLsC-w&t=931s){:target="_blank"}