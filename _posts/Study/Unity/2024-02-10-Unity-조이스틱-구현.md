---
title: (Unity) ì¡°ì´ìŠ¤í‹± êµ¬í˜„
author: LHH
date: 2024-02-10 16:54 GMT+0900
categories: [Study, Unity]
tags: [Unity, ì¡°ì´ìŠ¤í‹±, Joystick]
---

ëª¨ë°”ì¼ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì¡°ì´ìŠ¤í‹±ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

## 1. ì¤€ë¹„ë¬¼

- **Object**
    - Player

- **UI**
    - ì›í˜• í‹€
        - ì›í˜• *(ì›í˜• í‹€ì˜ ìì‹ ê°ì²´ë¡œ ë„£ê¸°)*

<br>

## 2. ì½”ë“œ
### ğŸ’» Scene UI ì½”ë“œ
í”Œë ˆì´ì–´ì˜ í„°ì¹˜ë¥¼ í™•ì¸í•˜ê³  ì¡°ì´ìŠ¤í‹±ì˜ í™œì„±í™”/ë¹„í™œì„±í™”, ë“œë˜ê·¸ ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
```cs
public class UI_GameScene : MonoBehaviour, IBeginDragHandler, IDragHandler, IEndDragHandler,
{
    [SerializeField]
    private UI_Joystick _joystickUI;

    // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ì¡°ì´ìŠ¤í‹± ì‹œì‘
    public void OnBeginDrag(PointerEventData eventData)
    {
        _joystickUI.OnJoystick(eventData);
    }

    // ë“œë˜ê·¸ ì¤‘ì¼ ì‹œ í”Œë ˆì´ì–´ ì´ë™
    public void OnDrag(PointerEventData eventData)
    {
        _joystickUI.JoystickDrag(eventData);
    }

    // ë“œë˜ê·¸ í•´ì œ ì‹œ ì¡°ì´ìŠ¤í‹± ë¹„í™œì„±í™”
    public void OnEndDrag(PointerEventData eventData)
    {
        _joystickUI.OffJoystick();
    }
}
```

### ğŸ’» ì¡°ì´ìŠ¤í‹± ì½”ë“œ
ì¡°ì´ìŠ¤í‹±ì„ ì¡°ì‘í•˜ê³  í”Œë ˆì´ì–´ì—ê²Œ ì´ë™ê°’ì„ ì „ë‹¬í•©ë‹ˆë‹¤.

ì¡°ì´ìŠ¤í‹±ì˜ ë°‹ë°‹í•œ ì‚¬ìš©ê°ì„ `_speed`, `_length`ë¥¼ í†µí•´ ìì—°ìŠ¤ëŸ½ê²Œ êµ¬í˜„í•©ë‹ˆë‹¤.

- `_speed` : ì›í˜•(Handle)ì´ í„°ì¹˜í•œ ì†ê°€ë½ì„ ë”°ë¼ê°€ëŠ” ì†ë„

- `_length` : ì›í˜•(Handle)ì´ ì›í˜• í‹€ì— ë”± ê±¸ì¹˜ëŠ” ê²ƒì„ **1**ì´ë¼ê³  í• ë•Œ ì–¼ë§ˆë‚˜ ëœ ê±¸ì¹˜ê²Œ í• ì§€

```cs
public class UI_Joystick : MonoBehaviour
{
    [SerializeField]
    private PlayerController _player;           // í”Œë ˆì´ì–´ ê°ì²´

    [SerializeField]
    private RectTransform   _handle;            // ì›í˜• í‹€ ì•ˆì— ìˆëŠ” ì›í˜• ê°ì²´

    private Vector2         _touch;             // í„°ì¹˜í•œ ìœ„ì¹˜

    private float           _widthHalf;         // ì›í˜• í‹€ì˜ ë°˜ì§€ë¦„

    [SerializeField]
    private float           _speed  = 0.35f;    // _speedì˜ Handleì´  í„°ì¹˜í•œ ì†ê°€ë½ì„ ì«“ëŠ” ì†ë„

    [SerializeField]
    private float           _length = 0.8f;     // _handleì˜ ìµœëŒ€ ì´ë™ ê¸¸ì´
    
    private void Start()
    {
        // ì›í˜• í‹€ì˜ ë°˜ì§€ë¦„
        _widthHalf  = GetComponent<RectTransform>().sizeDelta.x * 0.5f;

        gameObject.SetActive(false);
    }
    
    // ì¡°ì´ìŠ¤í‹± í•¸ë“¤ëŸ¬ ë“œë˜ê·¸
    public void JoystickDrag(PointerEventData eventData)
    {
        // í„°ì¹˜í•œ ìœ„ì¹˜ì™€ ì›í˜•ì˜ ìœ„ì¹˜ ì°¨ì´ë¥¼ êµ¬í•˜ê³  ë°˜ì§€ë¦„ìœ¼ë¡œ ë‚˜ëˆ ì£¼ê¸°
        _touch = ((eventData.position - (Vector2)transform.position) * _speed) / _widthHalf;
        
        // ì›í˜• í‹€ì— ê±¸ì¹˜ëŠ” Handle ê¸¸ì´ í™•ì¸
        if (_touch.magnitude > _length)
            _touch = _touch.normalized * _length;
            
        // Handle ìœ„ì¹˜ ì„¤ì •
        _handle.anchoredPosition = _touch * _widthHalf;

        // í”Œë ˆì´ì–´ì—ê²Œ ì¡°ì´ìŠ¤í‹±ê°’ ì „ë‹¬
        _player.joystickValue = new Vector2(_touch.x, _touch.y);
    }

    // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ì— ì¡°ì´ìŠ¤í‹± í™œì„±í™”
    public void OnJoystick(PointerEventData eventData)
    {
        gameObject.SetActive(true);
        
        transform.position = eventData.position;
    }

    // ì¡°ì´ìŠ¤í‹± ë¹„í™œì„±í™”
    public void OffJoystick()
    {
        gameObject.SetActive(false);

        // ìœ„ì¹˜ ì´ˆê¸°í™”
        _touch = Vector2.zero;
        _handle.anchoredPosition = Vector2.zero;
    }
}
```

### ğŸ’» í”Œë ˆì´ì–´ ì½”ë“œ
ì¡°ì´ìŠ¤í‹±ì˜ ì´ë™ê°’ì„ ì „ë‹¬ë°›ì•„ ì›€ì§ì„ì„ êµ¬í˜„í•©ë‹ˆë‹¤.
```cs
public class PlayerController : MonoBehaviour
{
    public Vector2 joystickValue = Vector2.zero;

    [SerializeField]
    private float speed = 6.5f;

    private void Update()
    {
        UpdateMove();
    }

    private void UpdateMove()
    {
        // ì¡°ì´ìŠ¤í‹± ê°’ì„ ê°€ì§€ê³  ì´ë™ê°’ ê³„ì‚°
        Vector3 rightMovement = Vector3.right * Time.deltaTime * joystickValue.x * speed;
        Vector3 upMovement = Vector3.forward * Time.deltaTime * joystickValue.y * speed;

        // ìœ„ì¹˜ ì´ë™
        transform.position += upMovement;
        transform.position += rightMovement;

        // ìœ„ì¹˜ ë°©í–¥ ë°”ë¼ë³´ê¸°
        transform.rotation = Quaternion.Euler(0f, Mathf.Atan2(joystickValue.x, joystickValue.y) * Mathf.Rad2Deg, 0f);
    }
}
```

<br>

## 3. ê²°ê³¼

<div align="center">

  <img src="https://github.com/LHuHyeon/LHuHyeon.github.io/assets/110723307/3dd5589e-bd13-450a-a6a0-bbf8bb226e32" width="50%" height="70%"/>

</div>

<br>

## ğŸ’¡ ì°¸ê³ 
- [ìœ ë‹ˆí‹° ì¡°ì´ìŠ¤í‹±ìœ¼ë¡œ ìºë¦­í„° ì´ë™í•˜ê¸°](https://unitybeginner.tistory.com/30)